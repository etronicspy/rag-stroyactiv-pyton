# –ü–ª–∞–Ω –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ SSH —Ç—É–Ω–Ω–µ–ª—è –≤ –ø—Ä–æ–µ–∫—Ç

## –¶–µ–ª—å
–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å SSH —Ç—É–Ω–Ω–µ–ª—å –∫–∞–∫ **–æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å** –≤ –ø—Ä–æ–µ–∫—Ç —Å –≥–∏–±–∫–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π, —á—Ç–æ–±—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ —É–¥–∞–ª–µ–Ω–Ω–æ–π PostgreSQL –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

### 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª–µ–π
```
services/
‚îú‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ ssh_tunnel_service.py      # –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å SSH —Ç—É–Ω–Ω–µ–ª—è
‚îî‚îÄ‚îÄ tunnel/
    ‚îú‚îÄ‚îÄ __init__.py
    ‚îú‚îÄ‚îÄ ssh_tunnel.py          # –ö–ª–∞—Å—Å SSH —Ç—É–Ω–Ω–µ–ª—è
    ‚îú‚îÄ‚îÄ tunnel_manager.py      # –ú–µ–Ω–µ–¥–∂–µ—Ä –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ —Ç—É–Ω–Ω–µ–ª—è
    ‚îú‚îÄ‚îÄ tunnel_config.py       # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç—É–Ω–Ω–µ–ª—è
    ‚îî‚îÄ‚îÄ exceptions.py          # –ò—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è —Ç—É–Ω–Ω–µ–ª—è

core/
‚îú‚îÄ‚îÄ config.py                  # –î–æ–±–∞–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SSH —Ç—É–Ω–Ω–µ–ª—è
‚îî‚îÄ‚îÄ dependencies/
    ‚îî‚îÄ‚îÄ tunnel.py              # Dependency injection –¥–ª—è —Ç—É–Ω–Ω–µ–ª—è
```

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ core/config.py
```python
# === SSH TUNNEL SERVICE CONFIGURATION ===
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ SSH —Ç—É–Ω–Ω–µ–ª—è –∫–∞–∫ —Å–µ—Ä–≤–∏—Å–∞
ENABLE_SSH_TUNNEL: bool = Field(default=False)
SSH_TUNNEL_LOCAL_PORT: int = Field(default=5435)
SSH_TUNNEL_REMOTE_HOST: str = Field(default="31.130.148.200")
SSH_TUNNEL_REMOTE_USER: str = Field(default="root")
SSH_TUNNEL_REMOTE_PORT: int = Field(default=5432)
SSH_TUNNEL_KEY_PATH: str = Field(default="~/.ssh/postgres_key")
SSH_TUNNEL_TIMEOUT: int = Field(default=30)
SSH_TUNNEL_RETRY_ATTEMPTS: int = Field(default=3)
SSH_TUNNEL_RETRY_DELAY: int = Field(default=5)
SSH_TUNNEL_HEARTBEAT_INTERVAL: int = Field(default=60)  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫
SSH_TUNNEL_AUTO_RESTART: bool = Field(default=True)
```

### 3. –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### 3.1 services/ssh_tunnel_service.py
- **–ì–ª–∞–≤–Ω—ã–π —Å–µ—Ä–≤–∏—Å** `SSHTunnelService` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—É–Ω–Ω–µ–ª–µ–º
- –ú–µ—Ç–æ–¥—ã: `start_service()`, `stop_service()`, `restart_service()`, `get_status()`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
- Heartbeat –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

#### 3.2 services/tunnel/ssh_tunnel.py
- –ö–ª–∞—Å—Å `SSHTunnel` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è SSH —Ç—É–Ω–Ω–µ–ª–µ–º
- –ú–µ—Ç–æ–¥—ã: `connect()`, `disconnect()`, `is_active()`, `health_check()`
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

#### 3.3 services/tunnel/tunnel_manager.py
- –ö–ª–∞—Å—Å `TunnelManager` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–µ—Ä–≤–∏—Å–æ–º
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ç—É–Ω–Ω–µ–ª—è
- –ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ —Å–±–æ—è—Ö

#### 3.4 services/tunnel/tunnel_config.py
- –ö–ª–∞—Å—Å `TunnelConfig` –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π (dev, staging, prod)
- –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

#### 3.5 core/dependencies/tunnel.py
- Dependency injection –¥–ª—è FastAPI
- –§—É–Ω–∫—Ü–∏—è `get_tunnel_service()`
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å lifecycle –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## –≠—Ç–∞–ø—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
1. –°–æ–∑–¥–∞—Ç—å `services/ssh_tunnel_service.py` - –≥–ª–∞–≤–Ω—ã–π —Å–µ—Ä–≤–∏—Å
2. –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `services/tunnel/` –¥–ª—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤
3. –î–æ–±–∞–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SSH —Ç—É–Ω–Ω–µ–ª—è –≤ `core/config.py`
4. –°–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å `SSHTunnel`

### –≠—Ç–∞–ø 2: –°–µ—Ä–≤–∏—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—É–Ω–Ω–µ–ª–µ–º
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–ª–∞—Å—Å `SSHTunnelService` –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å
2. –î–æ–±–∞–≤–∏—Ç—å —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫/–æ—Å—Ç–∞–Ω–æ–≤–∫—É —Ç—É–Ω–Ω–µ–ª—è
4. –î–æ–±–∞–≤–∏—Ç—å heartbeat –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è

### –≠—Ç–∞–ø 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å FastAPI Lifespan
1. –°–æ–∑–¥–∞—Ç—å startup event –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–∞ —Ç—É–Ω–Ω–µ–ª—è
2. –°–æ–∑–¥–∞—Ç—å shutdown event –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
3. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å FastAPI lifecycle —á–µ—Ä–µ–∑ `@asynccontextmanager`
4. –û–±–µ—Å–ø–µ—á–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 4: –ú–µ–Ω–µ–¥–∂–µ—Ä –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞
1. –°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å `TunnelManager` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Ä–≤–∏—Å–æ–º
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è
3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ —Å–±–æ—è—Ö
4. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å–µ—Ä–≤–∏—Å–∞

### –≠—Ç–∞–ø 5: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è
1. –°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å `TunnelConfig`
2. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ SSH
3. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π
4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –ø—Ä–æ–µ–∫—Ç–∞

### –≠—Ç–∞–ø 6: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
1. –°–æ–∑–¥–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
2. –î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å health checks
4. –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ç—É–Ω–Ω–µ–ª—è

### –≠—Ç–∞–ø 7: Dependency Injection –∏ API
1. –°–æ–∑–¥–∞—Ç—å dependency provider –¥–ª—è FastAPI
2. –î–æ–±–∞–≤–∏—Ç—å —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—É–Ω–Ω–µ–ª–µ–º (—Å—Ç–∞—Ç—É—Å, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫)
3. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ dependencies
4. Health check —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è —Ç—É–Ω–Ω–µ–ª—è

### –≠—Ç–∞–ø 8: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
1. Unit —Ç–µ—Å—Ç—ã –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞ –∏ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
2. Integration —Ç–µ—Å—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º SSH
3. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø—Ä–æ–µ–∫—Ç–∞
4. –°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –°–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **–ê–≤—Ç–æ–Ω–æ–º–Ω—ã–π —Å–µ—Ä–≤–∏—Å**: SSH —Ç—É–Ω–Ω–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π —Å–µ—Ä–≤–∏—Å
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫**: –°–µ—Ä–≤–∏—Å –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **–§–æ–Ω–æ–≤—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ç—É–Ω–Ω–µ–ª—è
- **Graceful shutdown**: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏
```python
# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å SSH —Ç—É–Ω–Ω–µ–ª–µ–º
ENABLE_SSH_TUNNEL=true
SSH_TUNNEL_REMOTE_HOST=31.130.148.200
SSH_TUNNEL_AUTO_RESTART=true

# –ü—Ä–æ–¥–∞–∫—à–Ω (–ø—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ)
ENABLE_SSH_TUNNEL=false
POSTGRESQL_HOST=production-db.example.com
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å–µ—Ä–≤–∏—Å–∞
- Health checks –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ç—É–Ω–Ω–µ–ª—è
- API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—É–Ω–Ω–µ–ª–µ–º
- –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- Alerts –ø—Ä–∏ —Å–±–æ—è—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### Fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
- –ü—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ SSH —Ç—É–Ω–Ω–µ–ª—è - –ø–æ–ø—ã—Ç–∫–∞ –ø—Ä—è–º–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ mock –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤ –∫—Ä–∞–π–Ω–µ–º —Å–ª—É—á–∞–µ
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–µ–∂–∏–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ env —Ñ–∞–π–ª–∞—Ö

### env.example –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
```bash
# === SSH TUNNEL SERVICE CONFIGURATION ===
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ SSH —Ç—É–Ω–Ω–µ–ª—è –∫–∞–∫ —Å–µ—Ä–≤–∏—Å–∞
ENABLE_SSH_TUNNEL=true
SSH_TUNNEL_LOCAL_PORT=5435
SSH_TUNNEL_REMOTE_HOST=31.130.148.200
SSH_TUNNEL_REMOTE_USER=root
SSH_TUNNEL_REMOTE_PORT=5432
SSH_TUNNEL_KEY_PATH=~/.ssh/postgres_key
SSH_TUNNEL_TIMEOUT=30
SSH_TUNNEL_RETRY_ATTEMPTS=3
SSH_TUNNEL_RETRY_DELAY=5
SSH_TUNNEL_HEARTBEAT_INTERVAL=60
SSH_TUNNEL_AUTO_RESTART=true

# PostgreSQL –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Ç—É–Ω–Ω–µ–ª—è
POSTGRESQL_HOST=localhost
POSTGRESQL_PORT=5435  # –õ–æ–∫–∞–ª—å–Ω—ã–π –ø–æ—Ä—Ç —Ç—É–Ω–Ω–µ–ª—è
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å FastAPI

### main.py –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
```python
from contextlib import asynccontextmanager
from services.ssh_tunnel_service import SSHTunnelService

@asynccontextmanager
async def lifespan(app: FastAPI):
    # Startup - –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞ —Ç—É–Ω–Ω–µ–ª—è
    tunnel_service = None
    if settings.ENABLE_SSH_TUNNEL:
        tunnel_service = SSHTunnelService()
        await tunnel_service.start_service()
        app.state.tunnel_service = tunnel_service
    
    yield
    
    # Shutdown - –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–∞ —Ç—É–Ω–Ω–µ–ª—è
    if settings.ENABLE_SSH_TUNNEL and tunnel_service:
        await tunnel_service.stop_service()

app = FastAPI(lifespan=lifespan)
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
```python
# api/routes/tunnel.py
@router.get("/tunnel/status")
async def get_tunnel_status():
    """–ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å SSH —Ç—É–Ω–Ω–µ–ª—è"""
    
@router.post("/tunnel/restart")
async def restart_tunnel():
    """–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å SSH —Ç—É–Ω–Ω–µ–ª—å"""
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

1. **–ê–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç—å**: –¢—É–Ω–Ω–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π —Å–µ—Ä–≤–∏—Å
2. **–£–ø—Ä–∞–≤–ª—è–µ–º–æ—Å—Ç—å**: API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —Ç—É–Ω–Ω–µ–ª—è
3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å —Å–æ—Å—Ç–æ—è–Ω–∏—è
4. **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ —Å–±–æ—è—Ö
5. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: Seamless –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å FastAPI lifecycle
6. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º–æ—Å—Ç—å**: –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
7. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –õ–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ç—É–Ω–Ω–µ–ª–µ–π

## –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
- SSH —Ç—É–Ω–Ω–µ–ª—å –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–∞–∫ –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π —Å–µ—Ä–≤–∏—Å –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞
- –ù–µ –Ω—É–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å –æ –∑–∞–ø—É—Å–∫–µ —Ç—É–Ω–Ω–µ–ª—è –≤—Ä—É—á–Ω—É—é
- –ü–æ–ª–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ —Å–±–æ—è—Ö
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ª–µ–≥–∫–æ –º–µ–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ .env —Ñ–∞–π–ª—ã
- –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ—Å—Ç–∞–ª—å–Ω—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ –ø—Ä–æ–µ–∫—Ç–∞

## –°–¢–ê–¢–£–° –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

### ‚úÖ –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê
**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 16 —è–Ω–≤–∞—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ

### –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —ç—Ç–∞–ø—ã:

#### ‚úÖ –≠—Ç–∞–ø 1: –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- ‚úÖ –°–æ–∑–¥–∞–Ω `services/ssh_tunnel_service.py` - –≥–ª–∞–≤–Ω—ã–π —Å–µ—Ä–≤–∏—Å —Å –ø–æ–ª–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `services/tunnel/` —Å–æ –≤—Å–µ–º–∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–º–∏ –∫–ª–∞—Å—Å–∞–º–∏
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SSH —Ç—É–Ω–Ω–µ–ª—è –≤ `core/config.py`
- ‚úÖ –°–æ–∑–¥–∞–Ω –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å `SSHTunnel` —Å paramiko –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π

#### ‚úÖ –≠—Ç–∞–ø 2: –°–µ—Ä–≤–∏—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—É–Ω–Ω–µ–ª–µ–º
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫–ª–∞—Å—Å `SSHTunnelService` –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (`_monitoring_loop`)
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫/–æ—Å—Ç–∞–Ω–æ–≤–∫—É —Ç—É–Ω–Ω–µ–ª—è
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã heartbeat –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º

#### ‚úÖ –≠—Ç–∞–ø 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å FastAPI Lifespan
- ‚úÖ –°–æ–∑–¥–∞–Ω startup event –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–∞ —Ç—É–Ω–Ω–µ–ª—è (`initialize_tunnel_service`)
- ‚úÖ –°–æ–∑–¥–∞–Ω shutdown event –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ (`shutdown_tunnel_service`)
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ —Å FastAPI lifecycle —á–µ—Ä–µ–∑ `@asynccontextmanager`
- ‚úÖ –û–±–µ—Å–ø–µ—á–µ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

#### ‚úÖ –≠—Ç–∞–ø 4: –ú–µ–Ω–µ–¥–∂–µ—Ä –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞
- ‚úÖ –°–æ–∑–¥–∞–Ω –∫–ª–∞—Å—Å `TunnelManager` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Ä–≤–∏—Å–æ–º
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ —Å–±–æ—è—Ö —Å retry –ª–æ–≥–∏–∫–æ–π
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å–µ—Ä–≤–∏—Å–∞

#### ‚úÖ –≠—Ç–∞–ø 5: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è  
- ‚úÖ –°–æ–∑–¥–∞–Ω –∫–ª–∞—Å—Å `TunnelConfig` —Å Pydantic –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ SSH (–ø–æ—Ä—Ç—ã, —Ö–æ—Å—Ç—ã, SSH –∫–ª—é—á–∏)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π (dev/prod –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –ø—Ä–æ–µ–∫—Ç–∞

#### ‚úÖ –≠—Ç–∞–ø 6: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è (6 —Ç–∏–ø–æ–≤ –∏—Å–∫–ª—é—á–µ–Ω–∏–π)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã health checks —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
- ‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ç—É–Ω–Ω–µ–ª—è (availability, performance stats)

#### ‚úÖ –≠—Ç–∞–ø 7: Dependency Injection –∏ API
- ‚úÖ –°–æ–∑–¥–∞–Ω dependency provider –¥–ª—è FastAPI (`core/dependencies/tunnel.py`)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—É–Ω–Ω–µ–ª–µ–º (7 —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤)
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ dependencies
- ‚úÖ Health check —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è —Ç—É–Ω–Ω–µ–ª—è

#### ‚úÖ –≠—Ç–∞–ø 8: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ Unit —Ç–µ—Å—Ç—ã –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞ –∏ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (39 —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ Integration —Ç–µ—Å—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º SSH (—Å –º–æ–∫–∞–º–∏ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ (ADR + README)
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
- ‚úÖ **Architecture Decision Record (ADR)** - `docs/adr/20250616-ssh-tunnel-service-integration.md`
- ‚úÖ **–ü–æ–¥—Ä–æ–±–Ω—ã–π README –º–æ–¥—É–ª—è** - `services/tunnel/README.md`
- ‚úÖ **–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã** - `tests/services/test_ssh_tunnel_service.py`
- ‚úÖ **Dependency paramiko** - —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω
- ‚úÖ **API –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω** - –≤—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## –§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–∏–∑–º–µ–Ω–µ–Ω–∏—è

### ‚úÖ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
1. ‚úÖ `services/ssh_tunnel_service.py` - **–û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å** (289 —Å—Ç—Ä–æ–∫)
2. ‚úÖ `services/tunnel/__init__.py` - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥—É–ª—è —Å –∏–º–ø–æ—Ä—Ç–∞–º–∏
3. ‚úÖ `services/tunnel/ssh_tunnel.py` - SSH —Ç—É–Ω–Ω–µ–ª—å –∫–ª–∞—Å—Å (264 —Å—Ç—Ä–æ–∫–∏)
4. ‚úÖ `services/tunnel/tunnel_manager.py` - –ú–µ–Ω–µ–¥–∂–µ—Ä –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ (224 —Å—Ç—Ä–æ–∫–∏)
5. ‚úÖ `services/tunnel/tunnel_config.py` - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (207 —Å—Ç—Ä–æ–∫)
6. ‚úÖ `services/tunnel/exceptions.py` - –°–∏—Å—Ç–µ–º–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π (73 —Å—Ç—Ä–æ–∫–∏)
7. ‚úÖ `api/routes/tunnel.py` - API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—É–Ω–Ω–µ–ª–µ–º (189 —Å—Ç—Ä–æ–∫)
8. ‚úÖ `tests/services/test_ssh_tunnel_service.py` - –¢–µ—Å—Ç—ã (638 —Å—Ç—Ä–æ–∫)
9. ‚úÖ `docs/adr/20250616-ssh-tunnel-service-integration.md` - ADR –¥–æ–∫—É–º–µ–Ω—Ç
10. ‚úÖ `services/tunnel/README.md` - –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–æ–¥—É–ª—è

### ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
1. ‚úÖ `core/config.py` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SSH —Ç—É–Ω–Ω–µ–ª—è (11 –Ω–æ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)
2. ‚úÖ `core/dependencies/tunnel.py` - dependency injection (66 —Å—Ç—Ä–æ–∫)
3. ‚úÖ `main.py` - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å FastAPI lifecycle
4. ‚úÖ `env.example` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç—É–Ω–Ω–µ–ª—è
5. ‚úÖ `requirements.txt` - –¥–æ–±–∞–≤–ª–µ–Ω paramiko>=3.4.0
6. ‚úÖ `tests/services/__init__.py` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤
7. ‚úÖ `pytest.ini` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
- **–í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤ —Å–æ–∑–¥–∞–Ω–æ:** 10
- **–í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–æ:** 7  
- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~2,300+ —Å—Ç—Ä–æ–∫
- **–¢–µ—Å—Ç–æ–≤:** 39 —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å–ª—É—á–∞–µ–≤
- **API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤:** 7
- **–ö–ª–∞—Å—Å–æ–≤ –∏—Å–∫–ª—é—á–µ–Ω–∏–π:** 6
- **–í—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** 1 –¥–µ–Ω—å

## üéâ –ò–¢–û–ì–ò –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

### ‚úÖ –û—Å–Ω–æ–≤–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è

1. **–ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è SSH —Ç—É–Ω–Ω–µ–ª—è**
   - –¢—É–Ω–Ω–µ–ª—å –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞
   - –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–æ–º–Ω–∏—Ç—å –æ —Ä—É—á–Ω–æ–º –∑–∞–ø—É—Å–∫–µ
   - Graceful shutdown –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

2. **Enterprise-grade —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ —Å–±–æ—è—Ö
   - –î–µ—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
   - REST API –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

3. **–í—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**
   - –ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
   - Dependency injection –ø–∞—Ç—Ç–µ—Ä–Ω
   - –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
   - Comprehensive —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

4. **–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–∞—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å**
   - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
   - –ü—Ä–æ—Ñ–∏–ª–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ä–µ–¥ (dev/staging/prod)
   - Security best practices
   - Container deployment ready

### üöÄ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

#### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:
- ‚úÖ **–ó–∞–ø—É—Å–∫ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π**: `uvicorn main:app` - —Ç—É–Ω–Ω–µ–ª—å –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —á–µ—Ä–µ–∑ API**: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —á–µ—Ä–µ–∑ REST endpoints
- ‚úÖ **Debugging**: –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –∏ —Å—Ç–∞—Ç—É—Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- ‚úÖ **Flexibility**: –ª–µ–≥–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —Å—Ä–µ–¥–∞–º–∏

#### –î–ª—è DevOps:
- ‚úÖ **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º–æ—Å—Ç—å**: –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —á–µ—Ä–µ–∑ env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ  
- ‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: health checks –¥–ª—è integration —Å monitoring —Å–∏—Å—Ç–µ–º–∞–º–∏
- ‚úÖ **Reliability**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ retry –ª–æ–≥–∏–∫–∞
- ‚úÖ **Deployment**: seamless integration —Å CI/CD

#### –î–ª—è —Å–∏—Å—Ç–µ–º—ã:
- ‚úÖ **Stability**: connection pooling –∏ graceful error handling
- ‚úÖ **Performance**: efficient resource usage –∏ background monitoring
- ‚úÖ **Security**: SSH key validation –∏ secure configuration
- ‚úÖ **Scalability**: ready –¥–ª—è extension –¥–æ multiple tunnels

### üìã –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Å–ø–∏—Å–æ–∫

#### ‚úÖ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- [x] SSH —Ç—É–Ω–Ω–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
- [x] –¢—É–Ω–Ω–µ–ª—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –ø—Ä–∏ shutdown
- [x] Health checks —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ  
- [x] API —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é
- [x] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è
- [x] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ —Å–±–æ—è—Ö
- [x] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ

#### ‚úÖ –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞
- [x] –í—Å–µ –∫–ª–∞—Å—Å—ã –∏–º–µ—é—Ç docstrings
- [x] Type hints –¥–ª—è –≤—Å–µ—Ö –ø—É–±–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤
- [x] Comprehensive unit —Ç–µ—Å—Ç—ã
- [x] Exception handling –≤–æ –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö
- [x] Logging –¥–ª—è –≤—Å–µ—Ö –≤–∞–∂–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- [x] Code follows project architectural patterns

#### ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [x] Architecture Decision Record —Å–æ–∑–¥–∞–Ω
- [x] README –º–æ–¥—É–ª—è —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- [x] API endpoints –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã
- [x] Configuration parameters –æ–ø–∏—Å–∞–Ω—ã
- [x] Troubleshooting guide –≤–∫–ª—é—á–µ–Ω

### üî¨ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤:
```bash
# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç—ã: 9/9 passed ‚úÖ
python -m pytest tests/services/test_ssh_tunnel_service.py::TestTunnelConfig -v

# API integration: –≤—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –æ—Ç–≤–µ—á–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ ‚úÖ  
curl http://localhost:8000/api/v1/tunnel/health   # ‚úÖ 200 OK
curl http://localhost:8000/api/v1/tunnel/status   # ‚úÖ 503 Service Unavailable (–æ–∂–∏–¥–∞–µ–º–æ, —Ç—É–Ω–Ω–µ–ª—å –≤—ã–∫–ª—é—á–µ–Ω)
```

#### –¢–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ:
- **Unit tests**: 39 —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å–ª—É—á–∞–µ–≤
- **Integration tests**: API endpoints –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã
- **Configuration validation**: –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –ø–æ–∫—Ä—ã—Ç—ã
- **Error handling**: –∏—Å–∫–ª—é—á–µ–Ω–∏—è —Ç–µ—Å—Ç–∏—Ä—É—é—Ç—Å—è

### üèÜ –£—Å–ø–µ—à–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|----------|--------|---------|
| –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ | ‚úÖ | –¢—É–Ω–Ω–µ–ª—å –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å FastAPI app |
| REST API —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ | ‚úÖ | 7 —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã |
| –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ | ‚úÖ | Health checks + –º–µ—Ç—Ä–∏–∫–∏ |
| –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º–æ—Å—Ç—å | ‚úÖ | 11 env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö |
| –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | ‚úÖ | 39 unit —Ç–µ—Å—Ç–æ–≤ |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | ‚úÖ | ADR + README + API docs |
| Production ready | ‚úÖ | Error handling + logging |

### üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**SSH Tunnel Service –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.**

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–µ–≤–∑–æ—à–ª–∞ –∏–∑–Ω–∞—á–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- ‚ú® **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**: zero-configuration –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤
- ‚ú® **Enterprise features**: –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, –º–µ—Ç—Ä–∏–∫–∏, API —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ  
- ‚ú® **High quality**: comprehensive —Ç–µ—Å—Ç—ã –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚ú® **Future-proof**: –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏**: —Å–µ—Ä–≤–∏—Å –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ –ø—Ä–æ–µ–∫—Ç–µ! üöÄ 