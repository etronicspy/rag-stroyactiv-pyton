# üöÄ RAG Construction Materials API - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üìã –û–±–∑–æ—Ä

API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö –∏ AI-—ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤.

**Base URL**: `http://localhost:8000/api/v1`

---

## üè• Health & Monitoring

### `GET /health/`
–ë–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ API

**Response:**
```json
{
    "status": "healthy",
    "service": "RAG Construction Materials API",
    "version": "1.0.0",
    "timestamp": "2025-06-16T16:46:29.421964Z"
}
```

### `GET /health/full` 
–ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –≤—Å–µ—Ö —Å–∏—Å—Ç–µ–º

**Response:**
```json
{
    "overall_status": "healthy",
    "databases": {
        "vector_db": {
            "type": "qdrant_cloud",
            "status": "healthy",
            "response_time_ms": 156.3
        },
        "relational_db": {
            "type": "postgresql",
            "status": "healthy"
        }
    },
    "connection_pools": {
        "qdrant_pool": {"status": "healthy"},
        "postgresql_pool": {"status": "healthy"}
    }
}
```

---

## üì¶ Materials Management

### `POST /materials/`
–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞

**Request:**
```json
{
    "name": "–ü–æ—Ä—Ç–ª–∞–Ω–¥—Ü–µ–º–µ–Ω—Ç –ú500",
    "use_category": "–¶–µ–º–µ–Ω—Ç",
    "unit": "–º–µ—à–æ–∫",
    "description": "–í—ã—Å–æ–∫–æ–ø—Ä–æ—á–Ω—ã–π —Ü–µ–º–µ–Ω—Ç"
}
```

**Response:**
```json
{
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "name": "–ü–æ—Ä—Ç–ª–∞–Ω–¥—Ü–µ–º–µ–Ω—Ç –ú500",
    "use_category": "–¶–µ–º–µ–Ω—Ç",
    "unit": "–º–µ—à–æ–∫",
    "embedding": [0.023, -0.156, ...],
    "created_at": "2025-06-16T16:46:29.421964Z"
}
```

### `GET /materials/{id}`
–ü–æ–ª—É—á–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –ø–æ ID

### `PUT /materials/{id}`
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞

### `DELETE /materials/{id}` 
–£–¥–∞–ª–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞

### `GET /materials/`
–°–ø–∏—Å–æ–∫ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π

**Parameters:**
- `skip`: –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∑–∞–ø–∏—Å–∏ (default: 0)
- `limit`: –º–∞–∫—Å–∏–º—É–º –∑–∞–ø–∏—Å–µ–π (default: 10, max: 100)
- `category`: —Ñ–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

### `POST /materials/batch`
–ü–∞–∫–µ—Ç–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤

### `POST /materials/import`
–ò–º–ø–æ—Ä—Ç –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏–∑ JSON

---

## üîç Search Operations

### `GET /search/`
–ü—Ä–æ—Å—Ç–æ–π –ø–æ–∏—Å–∫ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤

**Parameters:**
- `q`: –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)
- `limit`: –º–∞–∫—Å–∏–º—É–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (default: 10)

**Example:**
```
GET /search/?q=—Ü–µ–º–µ–Ω—Ç&limit=5
```

### `POST /search/advanced`
–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –ø–æ–∏—Å–∫ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

**Request:**
```json
{
    "query": "–≤—ã—Å–æ–∫–æ–ø—Ä–æ—á–Ω—ã–π —Ü–µ–º–µ–Ω—Ç –¥–ª—è —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞",
    "search_type": "hybrid",
    "limit": 25,
    "categories": ["–¶–µ–º–µ–Ω—Ç"],
    "units": ["–º–µ—à–æ–∫", "—Ç"]
}
```

**Search Types:**
- `vector`: —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ (AI-powered)
- `sql`: —Ç–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫
- `fuzzy`: –Ω–µ—á–µ—Ç–∫–∏–π –ø–æ–∏—Å–∫ —Å –æ–ø–µ—á–∞—Ç–∫–∞–º–∏
- `hybrid`: –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### `GET /search/suggestions`
–ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–∏—Å–∫–∞

### `GET /search/categories`
–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤

### `GET /search/units`
–ï–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è

---

## üí∞ Price Management

### `POST /prices/process`
–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∞–π—Å-–ª–∏—Å—Ç–∞

**Request:**
```bash
curl -X POST "/api/v1/prices/process" \
  -F "file=@pricelist.csv" \
  -F "supplier_id=SUPPLIER001"
```

### `GET /prices/{supplier_id}/latest`
–ü–æ—Å–ª–µ–¥–Ω–∏–π –ø—Ä–∞–π—Å-–ª–∏—Å—Ç –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞

### `GET /prices/{supplier_id}/all` 
–í—Å–µ –ø—Ä–∞–π—Å-–ª–∏—Å—Ç—ã –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞

### `DELETE /prices/{supplier_id}`
–£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∞–π—Å-–ª–∏—Å—Ç–æ–≤

### `PATCH /prices/{supplier_id}/product/{id}/process`
–û—Ç–º–µ—Ç–∏—Ç—å –ø—Ä–æ–¥—É–∫—Ç –∫–∞–∫ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π

---

## üìö Reference Data

### `GET /reference/categories/`
–°–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π

### `POST /reference/categories/`
–°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

**Request:**
```json
{
    "name": "–ö–∏—Ä–ø–∏—á",
    "description": "–ö–µ—Ä–∞–º–∏—á–µ—Å–∫–∏–µ –∏ —Å–∏–ª–∏–∫–∞—Ç–Ω—ã–µ –∫–∏—Ä–ø–∏—á–∏"
}
```

### `DELETE /reference/categories/{id}`
–£–¥–∞–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

### `GET /reference/units/`
–°–ø–∏—Å–æ–∫ –µ–¥–∏–Ω–∏—Ü –∏–∑–º–µ—Ä–µ–Ω–∏—è

### `POST /reference/units/`
–°–æ–∑–¥–∞–Ω–∏–µ –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è

### `DELETE /reference/units/{id}`
–£–¥–∞–ª–µ–Ω–∏–µ –µ–¥–∏–Ω–∏—Ü—ã

---

## üîÑ Fallback Strategy

API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏:

1. **Vector Search** ‚Üí —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –≤ Qdrant
2. **SQL LIKE Search** ‚Üí –µ—Å–ª–∏ 0 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, SQL –ø–æ–∏—Å–∫
3. **Mock Mode** ‚Üí –µ—Å–ª–∏ –ë–î –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞

---

## üìä Response Codes

- `200` - –£—Å–ø–µ—à–Ω–æ
- `201` - –°–æ–∑–¥–∞–Ω–æ
- `400` - –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- `404` - –ù–µ –Ω–∞–π–¥–µ–Ω–æ
- `500` - –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
- `503` - –°–µ—Ä–≤–∏—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

---

## üöÄ Interactive Documentation

- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc
- **OpenAPI Schema**: http://localhost:8000/openapi.json

---

**–û–±–Ω–æ–≤–ª–µ–Ω–æ**: $(date +%Y-%m-%d) 